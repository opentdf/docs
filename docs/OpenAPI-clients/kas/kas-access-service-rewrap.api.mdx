---
id: kas-access-service-rewrap
title: "Rewrap"
description: "Rewrap"
sidebar_label: "Rewrap"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: kas
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Rewrap"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/kas/v2/rewrap"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Rewrap

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"signedRequestToken":{"type":"string","title":"signed_request_token","description":"A JWT signed by the DPoP (Demonstration of Proof of Possession) private key\n Required: Always\n Version differences:\n - v1 (legacy): Uses existing TDF spec schema in requestBody\n - v2 (bulk): Uses UnsignedRewrapRequest proto serialized as JSON in requestBody"}},"title":"RewrapRequest","additionalProperties":false,"description":"Request to rewrap (decrypt and re-encrypt) TDF keys for client access"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"Success","content":{"application/json":{"schema":{"type":"object","properties":{"metadata":{"type":"object","title":"metadata","additionalProperties":{"title":"value","oneOf":[{"type":"null"},{"type":"number"},{"type":"string"},{"type":"boolean"},{"type":"array"},{"type":"object","additionalProperties":true}],"description":"`Value` represents a dynamically typed value which can be either\n null, a number, a string, a boolean, a recursive struct value, or a\n list of values. A producer of value is expected to set one of these\n variants. Absence of any variant indicates an error.\n\n The JSON representation for `Value` is JSON value."},"description":"Deprecated: Legacy metadata field\n Modern responses use metadata in individual KeyAccessRewrapResult","deprecated":true},"entityWrappedKey":{"type":"string","title":"entity_wrapped_key","format":"byte","description":"Deprecated: Legacy single entity wrapped key\n Modern responses use kas_wrapped_key in KeyAccessRewrapResult","deprecated":true},"sessionPublicKey":{"type":"string","title":"session_public_key","description":"KAS's ephemeral session public key in PEM format\n Required: For EC-based operations (key_type=\"ec-wrapped\")\n Optional: Empty for RSA-based ZTDF (key_type=\"wrapped\")\n Used by client to perform ECDH key agreement and decrypt the kas_wrapped_key values"},"schemaVersion":{"type":"string","title":"schema_version","description":"Deprecated: Legacy schema version identifier\n Modern responses use implicit versioning","deprecated":true},"responses":{"type":"array","items":{"type":"object","properties":{"policyId":{"type":"string","title":"policy_id","description":"Policy identifier matching the policy.id from the request\n Required: Always matches the ID from UnsignedRewrapRequest_WithPolicy"},"results":{"type":"array","items":{"type":"object","oneOf":[{"properties":{"error":{"type":"string","title":"error","description":"Error message when rewrap failed\n Present when status=\"fail\"\n Human-readable description of the failure reason"}},"title":"error","required":["error"]},{"properties":{"kasWrappedKey":{"type":"string","title":"kas_wrapped_key","format":"byte","description":"Successfully rewrapped key encrypted with the session key\n Present when status=\"permit\"\n Contains the DEK encrypted with the ephemeral session key"}},"title":"kas_wrapped_key","required":["kasWrappedKey"]}],"properties":{"metadata":{"type":"object","title":"metadata","additionalProperties":{"title":"value","oneOf":[{"type":"null"},{"type":"number"},{"type":"string"},{"type":"boolean"},{"type":"array"},{"type":"object","additionalProperties":true}],"description":"`Value` represents a dynamically typed value which can be either\n null, a number, a string, a boolean, a recursive struct value, or a\n list of values. A producer of value is expected to set one of these\n variants. Absence of any variant indicates an error.\n\n The JSON representation for `Value` is JSON value."},"description":"Metadata associated with this KAO result (e.g., required obligations)\n Optional: May contain obligation requirements or other policy metadata\n Common keys: \"X-Required-Obligations\" with array of obligation FQNs"},"keyAccessObjectId":{"type":"string","title":"key_access_object_id","description":"Identifier matching the key_access_object_id from the request\n Required: Always matches the ID from UnsignedRewrapRequest_WithKeyAccessObject"},"status":{"type":"string","title":"status","description":"Status of the rewrap operation for this KAO\n Required: Always\n Values: \"permit\" (success), \"fail\" (failure)"}},"title":"KeyAccessRewrapResult","additionalProperties":false,"description":"Result of a key access object rewrap operation"},"title":"results","description":"Results for each KAO under this policy\n Required: One result per KAO in the original request"}},"title":"PolicyRewrapResult","additionalProperties":false,"description":"Result for all KAOs associated with a single policy"},"title":"responses","description":"Policy-grouped rewrap results for the bulk API\n Required: Modern v2 API responses\n Each PolicyRewrapResult contains results for all KAOs under that policy"}},"title":"RewrapResponse","additionalProperties":false,"description":"Response containing rewrapped keys and session information"}}}},"default":{"description":"Error","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","examples":["not_found"],"enum":["canceled","unknown","invalid_argument","deadline_exceeded","not_found","already_exists","permission_denied","resource_exhausted","failed_precondition","aborted","out_of_range","unimplemented","internal","unavailable","data_loss","unauthenticated"],"description":"The status code, which should be an enum value of [google.rpc.Code][google.rpc.Code]."},"message":{"type":"string","description":"A developer-facing error message, which should be in English. Any user-facing error message should be localized and sent in the [google.rpc.Status.details][google.rpc.Status.details] field, or localized by the client."},"detail":{"type":"object","properties":{"type":{"type":"string"},"value":{"type":"string","format":"binary"},"debug":{"type":"object","additionalProperties":true}},"additionalProperties":true,"description":"Contains an arbitrary serialized message along with a @type that describes the type of the serialized message.","title":"google.protobuf.Any"}},"title":"Connect Error","additionalProperties":true,"description":"Error type returned by Connect: https://connectrpc.com/docs/go/errors/#http-representation"}}}}}}
>
  
</StatusCodes>


      