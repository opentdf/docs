"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[7715],{77400:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>a,frontMatter:()=>t,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"getting-started/configuration","title":"Configuration","description":"This guide provides details about the configuration setup for the platform, including the logger, services , and server configurations.","source":"@site/docs/getting-started/configuration.md","sourceDirName":"getting-started","slug":"/getting-started/configuration","permalink":"/pr-172/getting-started/configuration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"id":"configuration","sidebar_position":20,"title":"Configuration"},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started","permalink":"/pr-172/getting-started"},"next":{"title":"Architecture","permalink":"/pr-172/architecture"}}');var s=i(74848),d=i(28453);const t={id:"configuration",sidebar_position:20,title:"Configuration"},l="Platform Configuration",c={},o=[{value:"Deployment Mode",id:"deployment-mode",level:2},{value:"Service Negation",id:"service-negation",level:3},{value:"SDK Configuration",id:"sdk-configuration",level:2},{value:"Logger Configuration",id:"logger-configuration",level:2},{value:"Server Configuration",id:"server-configuration",level:2},{value:"CORS Configuration",id:"cors-configuration",level:3},{value:"Additive Configuration",id:"additive-configuration",level:4},{value:"Programmatic Configuration",id:"programmatic-configuration",level:4},{value:"Crypto Provider",id:"crypto-provider",level:3},{value:"Tracing Configuration",id:"tracing-configuration",level:3},{value:"Database Configuration",id:"database-configuration",level:2},{value:"Security Configuration",id:"security-configuration",level:2},{value:"Services Configuration",id:"services-configuration",level:2},{value:"Key Access Server (KAS)",id:"key-access-server-kas",level:3},{value:"Authorization",id:"authorization",level:3},{value:"Shared Keys (v1 &amp; v2)",id:"shared-keys-v1--v2",level:4},{value:"Authorization v1 Only",id:"authorization-v1-only",level:4},{value:"Authorization v2 Only",id:"authorization-v2-only",level:4},{value:"Example: Authorization v1",id:"example-authorization-v1",level:4},{value:"Example: Authorization v2",id:"example-authorization-v2",level:4},{value:"Entity Resolution",id:"entity-resolution",level:3},{value:"Shared Keys (v1 &amp; v2)",id:"shared-keys-v1--v2-1",level:4},{value:"Entity Resolution v1 Only",id:"entity-resolution-v1-only",level:4},{value:"Entity Resolution v2 Only",id:"entity-resolution-v2-only",level:4},{value:"Example: Entity Resolution v1",id:"example-entity-resolution-v1",level:4},{value:"Example: Entity Resolution v2",id:"example-entity-resolution-v2",level:4},{value:"Policy",id:"policy",level:3},{value:"Casbin Endpoint Authorization",id:"casbin-endpoint-authorization",level:3},{value:"Key Aspects of Authorization Configuration",id:"key-aspects-of-authorization-configuration",level:4},{value:"Configuration in opentdf-example.yaml",id:"configuration-in-opentdf-exampleyaml",level:4},{value:"Role Permissions",id:"role-permissions",level:4},{value:"Managing Authorization Policy",id:"managing-authorization-policy",level:4},{value:"Cache Configuration",id:"cache-configuration",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"platform-configuration",children:"Platform Configuration"})}),"\n",(0,s.jsx)(n.p,{children:"This guide provides details about the configuration setup for the platform, including the logger, services , and server configurations."}),"\n",(0,s.jsxs)(n.p,{children:["The platform leverages ",(0,s.jsx)(n.a,{href:"https://github.com/spf13/viper",children:"viper"})," to help load configuration."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#platform-configuration",children:"Platform Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#deployment-mode",children:"Deployment Mode"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#service-negation",children:"Service Negation"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#sdk-configuration",children:"SDK Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#logger-configuration",children:"Logger Configuration"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#server-configuration",children:"Server Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#cors-configuration",children:"CORS Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#additive-configuration",children:"Additive Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#programmatic-configuration",children:"Programmatic Configuration"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#crypto-provider",children:"Crypto Provider"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#tracing-configuration",children:"Tracing Configuration"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#database-configuration",children:"Database Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#security-configuration",children:"Security Configuration"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#services-configuration",children:"Services Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#key-access-server-kas",children:"Key Access Server (KAS)"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#authorization",children:"Authorization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#shared-keys-v1--v2",children:"Shared Keys (v1 & v2)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#authorization-v1-only",children:"Authorization v1 Only"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#authorization-v2-only",children:"Authorization v2 Only"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#example-authorization-v1",children:"Example: Authorization v1"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#example-authorization-v2",children:"Example: Authorization v2"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#entity-resolution",children:"Entity Resolution"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#shared-keys-v1--v2-1",children:"Shared Keys (v1 & v2)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#entity-resolution-v1-only",children:"Entity Resolution v1 Only"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#entity-resolution-v2-only",children:"Entity Resolution v2 Only"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#example-entity-resolution-v1",children:"Example: Entity Resolution v1"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#example-entity-resolution-v2",children:"Example: Entity Resolution v2"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#policy",children:"Policy"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#casbin-endpoint-authorization",children:"Casbin Endpoint Authorization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#key-aspects-of-authorization-configuration",children:"Key Aspects of Authorization Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#configuration-in-opentdf-exampleyaml",children:"Configuration in opentdf-example.yaml"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#role-permissions",children:"Role Permissions"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#managing-authorization-policy",children:"Managing Authorization Policy"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#cache-configuration",children:"Cache Configuration"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"deployment-mode",children:"Deployment Mode"}),"\n",(0,s.jsx)(n.p,{children:"The platform is designed as a modular monolith, meaning that all services are built into and run from the same binary. However, these services can be grouped and run together based on specific needs. The available service groups are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"all: Runs every service that is registered within the platform."}),"\n",(0,s.jsx)(n.li,{children:"core: Runs essential services, including policy, authorization, and wellknown services."}),"\n",(0,s.jsx)(n.li,{children:"kas: Runs the Key Access Server (KAS) service."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"service-negation",children:"Service Negation"}),"\n",(0,s.jsxs)(n.p,{children:["You can exclude specific services from any mode using the negation syntax ",(0,s.jsx)(n.code,{children:"-servicename"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Syntax"}),": ",(0,s.jsx)(n.code,{children:"mode: <base-mode>,-<service1>,-<service2>"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Constraint"}),": At least one positive mode must be specified (negation-only modes like ",(0,s.jsx)(n.code,{children:"-kas"})," will result in an error)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Available services"}),": ",(0,s.jsx)(n.code,{children:"policy"}),", ",(0,s.jsx)(n.code,{children:"authorization"}),", ",(0,s.jsx)(n.code,{children:"kas"}),", ",(0,s.jsx)(n.code,{children:"entityresolution"}),", ",(0,s.jsx)(n.code,{children:"wellknown"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Run all services except Entity Resolution Service\nmode: all,-entityresolution\n\n# Run core services except Policy Service  \nmode: core,-policy\n\n# Run all services except both KAS and Entity Resolution\nmode: all,-kas,-entityresolution\n"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mode"})}),(0,s.jsxs)(n.td,{children:["Drives which services to run. Supported modes: ",(0,s.jsx)(n.code,{children:"all"}),", ",(0,s.jsx)(n.code,{children:"core"}),", ",(0,s.jsx)(n.code,{children:"kas"}),". Use ",(0,s.jsx)(n.code,{children:"-servicename"})," to exclude specific services (e.g., ",(0,s.jsx)(n.code,{children:"all,-entityresolution"}),")"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"all"})}),(0,s.jsx)(n.td,{children:"OPENTDF_MODE"})]})})]}),"\n",(0,s.jsx)(n.h2,{id:"sdk-configuration",children:"SDK Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The sdk configuration is used when operating the service in mode ",(0,s.jsx)(n.code,{children:"kas"}),". When running in mode ",(0,s.jsx)(n.code,{children:"core"})," or ",(0,s.jsx)(n.code,{children:"all"})," an in-process communication is leveraged over an in-memory grpc server."]}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"sdk_config"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"core.endpoint"})}),(0,s.jsx)(n.td,{children:"The core platform endpoint to connect to"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SDK_CONFIG_ENDPOINT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"core.plaintext"})}),(0,s.jsx)(n.td,{children:"Use a plaintext grpc connection"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SDK_CONFIG_PLAINTEXT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"core.insecure"})}),(0,s.jsx)(n.td,{children:"Use an insecure tls connection"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"entityresolution.endpoint"})}),(0,s.jsx)(n.td,{children:"The entityresolution endpoint to connect to"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"entityresolution.plaintext"})}),(0,s.jsx)(n.td,{children:"Use a plaintext ERS grpc connection"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"entityresolution.insecure"})}),(0,s.jsx)(n.td,{children:"Use an insecure tls connection"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"client_id"})}),(0,s.jsx)(n.td,{children:"OAuth client id"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SDK_CONFIG_CLIENT_ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"client_secret"})}),(0,s.jsx)(n.td,{children:"The clients credentials"}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SDK_CONFIG_CLIENT_SECRET"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"logger-configuration",children:"Logger Configuration"}),"\n",(0,s.jsx)(n.p,{children:"The logger configuration is used to define how the application logs its output."}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"logger"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"level"})}),(0,s.jsx)(n.td,{children:"The logging level."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"info"})}),(0,s.jsx)(n.td,{children:"OPENTDF_LOGGER_LEVEL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"type"})}),(0,s.jsx)(n.td,{children:"The format of the log output."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"json"})}),(0,s.jsx)(n.td,{children:"OPENTDF_LOGGER_TYPE"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"output"})}),(0,s.jsx)(n.td,{children:"Stream output for logs, stderr or stdout"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"stdout"})}),(0,s.jsx)(n.td,{children:"OPENTDF_LOGGER_OUTPUT"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"logger:\n  level: debug\n  type: text\n  output: stderr\n"})}),"\n",(0,s.jsx)(n.h2,{id:"server-configuration",children:"Server Configuration"}),"\n",(0,s.jsx)(n.p,{children:"The server configuration is used to define how the application runs its server."}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"server"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.audience"})}),(0,s.jsx)(n.td,{children:"The audience for the IDP."}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_AUTH_AUDIENCE"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.issuer"})}),(0,s.jsx)(n.td,{children:"The issuer for the IDP."}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_AUTH_ISSUER"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.policy"})}),(0,s.jsxs)(n.td,{children:["The Casbin policy for enforcing authorization on endpoints. Described ",(0,s.jsx)(n.a,{href:"#casbin-endpoint-authorization",children:"below"})]}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.cache_refresh"})}),(0,s.jsx)(n.td,{children:"Interval in which the IDP jwks should be refreshed"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"15m"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_AUTH_CACHE_REFRESH"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.dpopskew"})}),(0,s.jsx)(n.td,{children:"The amount of time drift allowed between when the client generated a dpop proof and the server time."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1h"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_AUTH"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.skew"})}),(0,s.jsxs)(n.td,{children:["The amount of time drift allowed between a tokens ",(0,s.jsx)(n.code,{children:"exp"})," claim and the server time."]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1m"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_AUTH_SKEW"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.public_client_id"})}),(0,s.jsx)(n.td,{children:"[DEPRECATED] The oidc client id. This is leveraged by otdfctl."}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_AUTH_PUBLIC_CLIENT_ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auth.enforceDPoP"})}),(0,s.jsx)(n.td,{children:"If true, DPoP bindings on Access Tokens are enforced."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_AUTH_ENFORCEDPOP"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cryptoProvider"})}),(0,s.jsxs)(n.td,{children:["A list of public/private keypairs and their use. Described ",(0,s.jsx)(n.a,{href:"#crypto-provider",children:"below"})]}),(0,s.jsx)(n.td,{children:"empty"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"enable_pprof"})}),(0,s.jsx)(n.td,{children:"Enable golang performance profiling"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_ENABLE_PPROF"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"grpc.reflection"})}),(0,s.jsx)(n.td,{children:"The configuration for the grpc server."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_GRPC_REFLECTION"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"public_hostname"})}),(0,s.jsx)(n.td,{children:"The public facing hostname for the server."}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_PUBLIC_HOSTNAME"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"host"})}),(0,s.jsx)(n.td,{children:"The host address for the server."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'""'})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_HOST"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"port"})}),(0,s.jsx)(n.td,{children:"The port number for the server."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"9000"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_PORT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tls.enabled"})}),(0,s.jsx)(n.td,{children:"Enable tls."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_TLS_ENABLED"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tls.cert"})}),(0,s.jsx)(n.td,{children:"The path to the tls certificate."}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_TLS_CERT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tls.key"})}),(0,s.jsx)(n.td,{children:"The path to the tls key."}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_TLS_KEY"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"server:\n  grpc:\n    reflection: true\n  port: 8081\n  tls:\n    enabled: true\n    cert: /path/to/cert\n    key: /path/to/key\n  auth:\n    enabled: true\n    audience: https://example.com\n    issuer: https://example.com\n  cryptoProvider:\n    standard:\n      keys:\n        - kid: r1\n          alg: rsa:2048\n          private: kas-private.pem\n          cert: kas-cert.pem\n        - kid: e1\n          alg: ec:secp256r1\n          private: kas-ec-private.pem\n          cert: kas-ec-cert.pem\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cors-configuration",children:"CORS Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"server.cors"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"enabled"})}),(0,s.jsx)(n.td,{children:"Enable CORS for the server"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ENABLED"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"allowedorigins"})}),(0,s.jsxs)(n.td,{children:["List of allowed origins (",(0,s.jsx)(n.code,{children:"*"})," for any)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[]"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ALLOWEDORIGINS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"allowedmethods"})}),(0,s.jsx)(n.td,{children:"List of allowed HTTP methods"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'["GET","POST","PATCH","DELETE","OPTIONS"]'})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ALLOWEDMETHODS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"allowedheaders"})}),(0,s.jsx)(n.td,{children:"List of allowed request headers"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'["Accept","Accept-Encoding","Authorization","Connect-Protocol-Version","Content-Length","Content-Type","Dpop","X-CSRF-Token","X-Requested-With","X-Rewrap-Additional-Context"]'})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ALLOWEDHEADERS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"exposedheaders"})}),(0,s.jsx)(n.td,{children:"List of response headers browsers can access"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[]"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_EXPOSEDHEADERS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"allowcredentials"})}),(0,s.jsx)(n.td,{children:"Whether credentials are included in CORS requests"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ALLOWCREDENTIALS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"maxage"})}),(0,s.jsx)(n.td,{children:"Maximum age (seconds) of preflight cache"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3600"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_MAXAGE"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"additionalmethods"})}),(0,s.jsx)(n.td,{children:"Additional methods to append to defaults"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[]"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ADDITIONALMETHODS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"additionalheaders"})}),(0,s.jsx)(n.td,{children:"Additional headers to append to defaults"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[]"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ADDITIONALHEADERS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"additionalexposedheaders"})}),(0,s.jsx)(n.td,{children:"Additional exposed headers to append"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[]"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_CORS_ADDITIONALEXPOSEDHEADERS"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"additive-configuration",children:"Additive Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"additional*"})," fields allow operators to extend the default lists without replacing them entirely:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"server:\n  cors:\n    enabled: true\n    # Add custom headers without copying all defaults\n    additionalheaders:\n      - X-Custom-Header\n      - X-Another-Header\n"})}),"\n",(0,s.jsx)(n.p,{children:"To completely replace defaults, use the base fields directly:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"server:\n  cors:\n    allowedheaders:\n      - Authorization\n      - Content-Type\n      # Only these headers will be allowed\n"})}),"\n",(0,s.jsx)(n.h4,{id:"programmatic-configuration",children:"Programmatic Configuration"}),"\n",(0,s.jsx)(n.p,{children:"For applications embedding the OpenTDF platform, CORS can also be configured programmatically using functional options. These are applied after YAML/environment configuration and follow the same additive semantics:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'import "github.com/opentdf/platform/service/pkg/server"\n\nerr := server.Start(\n    server.WithConfigFile("opentdf.yaml"),\n    // Add custom headers for your application\n    server.WithAdditionalCORSHeaders("X-Custom-Header", "X-App-Version"),\n    // Add custom methods if needed\n    server.WithAdditionalCORSMethods("CUSTOM"),\n    // Expose additional response headers to browsers\n    server.WithAdditionalCORSExposedHeaders("X-Request-Id", "X-Trace-Id"),\n)\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Configuration Precedence:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Defaults"})," - Built-in default values"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"YAML/Environment"})," - Operator configuration via ",(0,s.jsx)(n.code,{children:"server.cors.*"})," fields"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Programmatic Options"})," - Developer overlays via ",(0,s.jsx)(n.code,{children:"WithAdditionalCORS*"})," functions"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"All layers are additive. Deduplication is handled automatically (case-insensitive for headers per RFC 7230, case-sensitive for methods per RFC 7231)."}),"\n",(0,s.jsx)(n.h3,{id:"crypto-provider",children:"Crypto Provider"}),"\n",(0,s.jsx)(n.p,{children:"To configure the Key Access Server,\nyou must define a set of one or more public keypairs\nand a method for loading and using them."}),"\n",(0,s.jsx)(n.p,{children:"The crypto provider is implemented as an interface,\nallowing multiple implementations."}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"cryptoProvider"})]}),"\n",(0,s.jsxs)(n.p,{children:["Environment Variable: ",(0,s.jsx)(n.code,{children:'OPENTDF_SERVER_CRYPTOPROVIDER_STANDARD=\'[{"alg":"rsa:2048","kid":"k1","private":"kas-private.pem","cert":"kas-cert.pem"}]\''})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cryptoProvider.type"})}),(0,s.jsx)(n.td,{children:"The type of crypto provider to use."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"standard"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cryptoProvider.standard.*.alg"})}),(0,s.jsxs)(n.td,{children:["An enum for the associated crypto type. E.g. ",(0,s.jsx)(n.code,{children:"rsa:2048"})," or ",(0,s.jsx)(n.code,{children:"ec:secp256r1"})]}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cryptoProvider.standard.*.kid"})}),(0,s.jsx)(n.td,{children:"A short, globally unique, stable identifier for this keypair."}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cryptoProvider.standard.*.private"})}),(0,s.jsx)(n.td,{children:"Path to the private key as a PEM file."}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cryptoProvider.standard.*.cert"})}),(0,s.jsx)(n.td,{children:"(Optional) Path to a public cert for the keypair."}),(0,s.jsx)(n.td,{})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"tracing-configuration",children:"Tracing Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"server.trace"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"server.trace.enabled"})}),(0,s.jsx)(n.td,{children:"Enable distributed tracing"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_TRACE_ENABLED"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"server.trace.provider.name"})}),(0,s.jsx)(n.td,{children:"Tracing provider (file or otlp)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"otlp"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVER_TRACE_PROVIDER_NAME"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"For file provider:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.file.path"}),": Path to trace file output"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.file.prettyPrint"}),": Enable pretty-printed JSON"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.file.maxSize"}),": Maximum file size in MB"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.file.maxBackups"}),": Maximum number of backup files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.file.maxAge"}),": Maximum age of files in days"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.file.compress"}),": Enable compression of trace files"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"For OTLP provider:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.otlp.protocol"}),": Protocol to use (grpc or http/protobuf)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.otlp.endpoint"}),": Endpoint URL for the collector"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.otlp.insecure"}),": Whether to use an insecure connection"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server.trace.provider.otlp.headers"}),": Headers to include in OTLP requests"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'server:\n  trace:\n    enabled: true\n    provider:\n      name: otlp\n      otlp:\n        protocol: grpc\n        endpoint: "localhost:4317"\n        insecure: true\n'})}),"\n",(0,s.jsx)(n.h2,{id:"database-configuration",children:"Database Configuration"}),"\n",(0,s.jsx)(n.p,{children:"The database configuration is used to define how the application connects to its database."}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"db"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variables"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"host"})}),(0,s.jsx)(n.td,{children:"The host address for the database."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"localhost"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_HOST"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"port"})}),(0,s.jsx)(n.td,{children:"The port number for the database."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"5432"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_PORT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"database"})}),(0,s.jsx)(n.td,{children:"The name of the database."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"opentdf"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_DATABASE"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"user"})}),(0,s.jsx)(n.td,{children:"The username for the database."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"postgres"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_USER"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"password"})}),(0,s.jsx)(n.td,{children:"The password for the database."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"changeme"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_PASSWORD"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sslmode"})}),(0,s.jsx)(n.td,{children:"The ssl mode for the database"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"prefer"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_SSLMODE"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"schema"})}),(0,s.jsx)(n.td,{children:"The schema for the database."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"opentdf"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_SCHEMA"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"runMigration"})}),(0,s.jsx)(n.td,{children:"Whether to run the database migration or not."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_RUNMIGRATION"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"connect_timeout_seconds"})}),(0,s.jsx)(n.td,{children:"Connection timeout duration (seconds)."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"15"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_CONNECT_TIMEOUT_SECONDS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pool"})}),(0,s.jsx)(n.td,{children:"Pool configuration settings."}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pool.max_connection_count"})}),(0,s.jsx)(n.td,{children:"Maximum number of connections per pool."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_POOL_MAX_CONNECTION_COUNT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pool.min_connection_count"})}),(0,s.jsx)(n.td,{children:"Minimum number of connections per pool."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"0"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_POOL_MIN_CONNECTION_COUNT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pool.max_connection_lifetime_seconds"})}),(0,s.jsx)(n.td,{children:"Maximum seconds per connection lifetime."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3600"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_POOL_MAX_CONNECTION_LIFETIME_SECONDS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pool.min_idle_connections_count"})}),(0,s.jsx)(n.td,{children:"Minimum number of idle connections per pool."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"0"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_POOL_MIN_IDLE_CONNECTIONS_COUNT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pool.max_connection_idle_seconds"})}),(0,s.jsx)(n.td,{children:"Maximum seconds allowed for idle connection."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1800"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_POOL_MAX_CONNECTION_IDLE_SECONDS"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pool.health_check_period_seconds"})}),(0,s.jsx)(n.td,{children:"Interval seconds per health check."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"60"})}),(0,s.jsx)(n.td,{children:"OPENTDF_DB_POOL_HEALTH_CHECK_PERIOD_SECONDS"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"db:\n  host: localhost\n  port: 5432\n  database: opentdf\n  user: postgres\n  password: changeme\n  sslmode: require\n  schema: opentdf\n  runMigration: false\n  connect_timeout_seconds: 15\n  pool:\n    max_connection_count: 4\n    min_connection_count: 0\n    max_connection_lifetime_seconds: 3600\n    min_idle_connections_count: 0\n    max_connection_idle_seconds: 1800\n    health_check_period_seconds: 60\n"})}),"\n",(0,s.jsx)(n.h2,{id:"security-configuration",children:"Security Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"security"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"unsafe.clock_skew"})}),(0,s.jsx)(n.td,{children:"Platform-wide maximum tolerated clock skew for token verification (Go duration, use cautiously)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1m"})})]})})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Warning:"})," Increasing ",(0,s.jsx)(n.code,{children:"unsafe.clock_skew"})," weakens token freshness guarantees. Only raise this value temporarily while you correct clock drift."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"services-configuration",children:"Services Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"services"})]}),"\n",(0,s.jsx)(n.h3,{id:"key-access-server-kas",children:"Key Access Server (KAS)"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"kas"})]}),"\n",(0,s.jsxs)(n.p,{children:["Environment Variable: ",(0,s.jsx)(n.code,{children:'OPENTDF_SERVICES_KAS_KEYRING=\'[{"kid":"k1","alg":"rsa:2048"},{"kid":"k2","alg":"ec:secp256r1"}]\''})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"keyring.*.kid"})}),(0,s.jsx)(n.td,{children:"Which key id this is binding"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"keyring.*.alg"})}),(0,s.jsx)(n.td,{children:"(Optional) Associated algorithm. (Allows reusing KID with different algorithms)"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"keyring.*.legacy"})}),(0,s.jsx)(n.td,{children:"Indicates this may be used for TDFs with no key ID; default if all unspecified."}),(0,s.jsx)(n.td,{children:"inferred"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"preview.ec_tdf_enabled"})}),(0,s.jsx)(n.td,{children:"Whether tdf based ecc support is enabled."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"preview.key_management"})}),(0,s.jsx)(n.td,{children:"Whether new key management features are enabled."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"root_key"})}),(0,s.jsx)(n.td,{children:"Key needed when new key_management functionality is enabled."}),(0,s.jsx)(n.td,{})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"security:\n  unsafe:\n    # Increase only when diagnosing clock drift issues\n    # clock_skew: 90s\n\nservices:\n  kas:\n    keyring:\n      - kid: e2\n        alg: ec:secp256r1\n      - kid: e1\n        alg: ec:secp256r1\n        legacy: true\n      - kid: r2f\n        alg: rsa:2048\n      - kid: r1\n        alg: rsa:2048\n        legacy: true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"authorization",children:"Authorization"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"authorization"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Both Authorization v1 and v2 use the same configuration section, but some keys are version-specific. See below for details."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"shared-keys-v1--v2",children:"Shared Keys (v1 & v2)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variables"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.em,{children:"(none currently; all keys are version-specific)"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"authorization-v1-only",children:"Authorization v1 Only"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variables"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"rego.path"})}),(0,s.jsx)(n.td,{children:"Path to rego policy file"}),(0,s.jsx)(n.td,{children:"Leverages embedded rego policy"}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_AUTHORIZATION_REGO_PATH"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"rego.query"})}),(0,s.jsx)(n.td,{children:"Rego query to execute"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"data.opentdf.entitlements.attributes"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_AUTHORIZATION_REGO_QUERY"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"authorization-v2-only",children:"Authorization v2 Only"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variables"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"entitlement_policy_cache.enabled"})}),(0,s.jsx)(n.td,{children:"Enable the entitlement policy cache"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"entitlement_policy_cache.refresh_interval"})}),(0,s.jsxs)(n.td,{children:["How often to refresh the entitlement policy cache (e.g. ",(0,s.jsx)(n.code,{children:"30s"}),")"]}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"example-authorization-v1",children:"Example: Authorization v1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"services:\n  authorization:\n    rego:\n      path: /path/to/policy.rego\n      query: data.opentdf.entitlements.attributes\n"})}),"\n",(0,s.jsx)(n.h4,{id:"example-authorization-v2",children:"Example: Authorization v2"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"services:\n  authorization:\n    entitlement_policy_cache:\n      enabled: false\n      refresh_interval: 30s\n"})}),"\n",(0,s.jsx)(n.h3,{id:"entity-resolution",children:"Entity Resolution"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"entityresolution"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Both Entity Resolution v1 and v2 use the same configuration section. All configuration keys are shared between v1 and v2, except ",(0,s.jsx)(n.code,{children:"cache_expiration"}),", which is only used in v2."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"shared-keys-v1--v2-1",children:"Shared Keys (v1 & v2)"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mode"})}),(0,s.jsxs)(n.td,{children:["The mode in which to run ERS (",(0,s.jsx)(n.code,{children:"keycloak"})," or ",(0,s.jsx)(n.code,{children:"claims"}),")"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"keycloak"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_MODE"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"url"})}),(0,s.jsxs)(n.td,{children:["Endpoint URL for the entity resolution service (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'""'})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_URL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"clientid"})}),(0,s.jsxs)(n.td,{children:["Keycloak client ID for authentication (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'""'})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_CLIENTID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"clientsecret"})}),(0,s.jsxs)(n.td,{children:["Keycloak client secret for authentication(specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:'""'})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_CLIENTSECRET"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"realm"})}),(0,s.jsxs)(n.td,{children:["Keycloak realm for authentication (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_REALM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"legacykeycloak"})}),(0,s.jsxs)(n.td,{children:["Enables legacy Keycloak compatibility (",(0,s.jsx)(n.code,{children:"/auth"})," as base endpoint) (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_LEGACYKEYCLOAK"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"inferid.from.email"})}),(0,s.jsxs)(n.td,{children:["Infer entity IDs from email addresses (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_INFERID_FROM_EMAIL"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"inferid.from.username"})}),(0,s.jsxs)(n.td,{children:["Infer entity IDs from usernames (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_INFERID_FROM_USERNAME"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"inferid.from.clientid"})}),(0,s.jsxs)(n.td,{children:["Infer entity IDs from client IDs (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_ENTITYRESOLUTION_INFERID_FROM_CLIENTID"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"entity-resolution-v1-only",children:"Entity Resolution v1 Only"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variables"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.em,{children:"(none currently)"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"entity-resolution-v2-only",children:"Entity Resolution v2 Only"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variable"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"cache_expiration"})}),(0,s.jsxs)(n.td,{children:["Cache duration for entity resolution results (e.g., ",(0,s.jsx)(n.code,{children:"30s"}),"). Disabled if not set or zero. (specific to ",(0,s.jsx)(n.code,{children:"keycloak"})," mode)"]}),(0,s.jsx)(n.td,{children:"disabled"}),(0,s.jsx)(n.td,{})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"example-entity-resolution-v1",children:"Example: Entity Resolution v1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'services:\n  entityresolution:\n    url: http://localhost:8888/auth\n    clientid: "tdf-entity-resolution"\n    clientsecret: "secret"\n    realm: "opentdf"\n    legacykeycloak: true\n    inferid:\n      from:\n        email: true\n        username: true\n'})}),"\n",(0,s.jsx)(n.h4,{id:"example-entity-resolution-v2",children:"Example: Entity Resolution v2"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'services:\n  entityresolution:\n    url: http://localhost:8888/auth\n    clientid: "tdf-entity-resolution"\n    clientsecret: "secret"\n    realm: "opentdf"\n    legacykeycloak: true\n    inferid:\n      from:\n        email: true\n        username: true\n    cache_expiration: 30s\n'})}),"\n",(0,s.jsx)(n.h3,{id:"policy",children:"Policy"}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"policy"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Environment Variables"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"list_request_limit_default"})}),(0,s.jsx)(n.td,{children:"Policy List request limit default when not provided"}),(0,s.jsx)(n.td,{children:"1000"}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_POLICY_LIST_REQUEST_LIMIT_DEFAULT"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"list_request_limit_max"})}),(0,s.jsx)(n.td,{children:"Policy List request limit maximum enforced by services"}),(0,s.jsx)(n.td,{children:"2500"}),(0,s.jsx)(n.td,{children:"OPENTDF_SERVICES_POLICY_LIST_REQUEST_LIMIT_MAX"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"services:\n  policy:\n    list_request_limit_default: 1000\n    list_request_limit_max: 2500\n"})}),"\n",(0,s.jsx)(n.h3,{id:"casbin-endpoint-authorization",children:"Casbin Endpoint Authorization"}),"\n",(0,s.jsx)(n.p,{children:"OpenTDF uses Casbin to manage authorization policies. This document provides an overview of how to configure and manage the default authorization policy in OpenTDF."}),"\n",(0,s.jsx)(n.h4,{id:"key-aspects-of-authorization-configuration",children:"Key Aspects of Authorization Configuration"}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Username Claim"}),": The claim in the OIDC token that should be used to extract a username."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Group Claim"}),": The claim in the OIDC token that should be used to find the group claims."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Map (Deprecated)"}),": Mapping between policy roles and IdP roles."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Extension"}),": Policy that will extend the builtin policy"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CSV"}),": The authorization policy in CSV format. This will override the builtin policy."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Model"}),": The Casbin policy model. This should only be set if you have a deep understanding of how casbin works."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"configuration-in-opentdf-exampleyaml",children:"Configuration in opentdf-example.yaml"}),"\n",(0,s.jsx)(n.p,{children:"Below is an example configuration snippet from\nopentdf-example.yaml:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'server:\n  auth:\n    enabled: true\n    enforceDPoP: false\n    # public_client_id: \'opentdf-public\' # DEPRECATED\n    audience: \'http://localhost:8080\'\n    issuer: http://keycloak:8888/auth/realms/opentdf\n    policy:\n      \n      ## Deprecated\n      ## Dot notation is used to access nested claims (i.e. realm_access.roles)\n      claim: "realm_access.roles"\n\n      ## Dot notation is used to access the username claim\n      username_claim: "email"\n\n      ## Dot notation is used to access the groups claim\n      group_claim: "realm_access.roles"\n\n      # Dot notation is used to access the claim the represents the idP client ID \n      client_id_claim: # azp\n      \n      ## Deprecated: Use standard casbin policy groupings (g, <user/group>, <role>)\n      ## Maps the external role to the OpenTDF role\n      ## Note: left side is used in the policy, right side is the external role\n      map:\n        standard: opentdf-standard\n        admin: opentdf-admin\n\n      ## Policy that will extend the builtin policy.\n      extension: |\n        p, role:admin, *, *, allow\n        p, role:standard, policy:attributes, read, allow\n        p, role:standard, policy:subject-mappings, read, allow\n        g, opentdf-admin, role:admin\n        g, alice@opentdf.io, role:standard\n\n      ## Custom policy (see examples https://github.com/casbin/casbin/tree/master/examples)\n      ## This will overwrite the builtin policy. Use with caution. \n      csv: |\n        p, role:admin, *, *, allow\n        p, role:standard, policy:attributes, read, allow\n        p, role:standard, policy:subject-mappings, read, allow\n        p, role:standard, policy:resource-mappings, read, allow\n        p, role:standard, policy:kas-registry, read, allow\n        p, role:unknown, entityresolution.EntityResolutionService.ResolveEntities, write, allow\n        p, role:unknown, kas.AccessService/Rewrap, *, allow\n\n      ## Custom model (see https://casbin.org/docs/syntax-for-models/)\n      ## Avoid setting this unless you have a deep understanding of how casbin works. \n      model: |\n        [request_definition]\n        r = sub, res, act, obj\n        \n        [policy_definition]\n        p = sub, res, act, obj, eft\n        \n        [role_definition]\n        g = _, _\n        \n        [policy_effect]\n        e = some(where (p.eft == allow)) && !some(where (p.eft == deny))\n        \n        [matchers]\n        m = g(r.sub, p.sub) && globOrRegexMatch(r.res, p.res) && globOrRegexMatch(r.act, p.act) && globOrRegexMatch(r.obj, p.obj)\n'})}),"\n",(0,s.jsx)(n.h4,{id:"role-permissions",children:"Role Permissions"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Admin"}),": Can perform all operations."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Standard User"}),": Can read."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Public Endpoints"}),": Accessible without specific roles."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"managing-authorization-policy",children:"Managing Authorization Policy"}),"\n",(0,s.jsxs)(n.p,{children:["Admins can manage the authorization policy directly in the YAML configuration file. For detailed configuration options, refer to the ",(0,s.jsx)(n.a,{href:"https://casbin.org/docs/en/syntax-for-models",children:"Casbin documentation"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"cache-configuration",children:"Cache Configuration"}),"\n",(0,s.jsx)(n.p,{children:"The platform supports a cache manager to improve performance for frequently accessed data. You can configure the cache backend and its resource usage."}),"\n",(0,s.jsxs)(n.p,{children:["Root level key ",(0,s.jsx)(n.code,{children:"cache"})]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Default"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ristretto.max_cost"})}),(0,s.jsx)(n.td,{children:"Maximum cost for the cache (e.g. 100mb, 1gb)"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"1gb"})})]})})]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"cache:\n  ristretto:\n    max_cost: 1gb              # Maximum cost (i.e. 1mb, 1gb) for the cache (default: 1gb)\n"})})]})}function a(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var r=i(96540);const s={},d=r.createContext(s);function t(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);