"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5904],{61554:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"spec/schema/opentdf/key_access_object","title":"Key Access Object","description":"A Key Access Object, found within the keyAccess array in encryptionInformation, stores information about how a specific payload encryption key (or key split/share) is stored and accessed, typically via a Key Access Server (KAS).","source":"@site/docs/spec/schema/opentdf/key_access_object.md","sourceDirName":"spec/schema/opentdf","slug":"/spec/schema/opentdf/key_access_object","permalink":"/preview-ad81f576/spec/schema/opentdf/key_access_object","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"key_access_object","sidebar_position":4,"title":"Key Access Object"},"sidebar":"tutorialSidebar","previous":{"title":"Encryption Information","permalink":"/preview-ad81f576/spec/schema/opentdf/encryption_information"},"next":{"title":"Method","permalink":"/preview-ad81f576/spec/schema/opentdf/method"}}');var n=s(74848),r=s(28453);const c={id:"key_access_object",sidebar_position:4,title:"Key Access Object"},d="Key Access Object",o={},a=[{value:"Example",id:"example",level:2},{value:"Fields",id:"fields",level:2},{value:"Policy Binding Object (keyAccess.policyBinding)",id:"policy-binding-object-keyaccesspolicybinding",level:2}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"key-access-object",children:"Key Access Object"})}),"\n",(0,n.jsxs)(t.p,{children:["A Key Access Object, found within the ",(0,n.jsx)(t.code,{children:"keyAccess"})," array in ",(0,n.jsx)(t.a,{href:"/preview-ad81f576/spec/schema/opentdf/encryption_information",children:(0,n.jsx)(t.code,{children:"encryptionInformation"})}),", stores information about how a specific payload encryption key (or key split/share) is stored and accessed, typically via a Key Access Server (KAS)."]}),"\n",(0,n.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "type": "wrapped",\n  "url": "https://kas.example.com:5000",\n  "kid": "6f3b6a82-2f30-4c8a-aef3-57c65b8e7387", // Optional KAS Key ID\n  "sid": "split-id-1", // Optional Split ID\n  "protocol": "kas",\n  "wrappedKey": "OqnOE...B82uw==", // Base64 encoded wrapped key\n  "policyBinding": {\n    "alg": "HS256",\n    "hash": "BzmgoIxZzMmIF42qzbdD4Rw30GtdaRSQL2Xlfms1OPs=" // Base64 encoded hash\n  },\n  "encryptedMetadata": "ZoJTNW24UMhnXIif0mSnqLVCU=" // Base64 encoded encrypted metadata\n}\n'})}),"\n",(0,n.jsx)(t.h2,{id:"fields",children:"Fields"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Parameter"}),(0,n.jsx)(t.th,{children:"Type"}),(0,n.jsx)(t.th,{children:"Description"}),(0,n.jsx)(t.th,{children:"Required?"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"type"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsxs)(t.td,{children:["Specifies how the key is stored/accessed.",(0,n.jsx)("br",{}),(0,n.jsx)(t.strong,{children:"Possible Values:"}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:"remote: Key stored remotely (legacy, details TBD)."}),(0,n.jsx)("li",{children:"wrapped: Default. The\xa0wrappedKey\xa0field contains the payload key encrypted with the KAS key identified by\xa0url\xa0(and optionally\xa0kid)."}),(0,n.jsx)("li",{children:"remoteWrapped: Key is wrapped, but managed by a distinct CKS (details TBD)."})]})]}),(0,n.jsx)(t.td,{children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"url"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"The base URL of the Key Access Server (KAS) responsible for this key or key share."}),(0,n.jsx)(t.td,{children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"protocol"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"Protocol used to interact with the\xa0url. Currently, only\xa0kas\xa0is specified."}),(0,n.jsx)(t.td,{children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"wrappedKey"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:'The Base64 encoded payload symmetric key (or key share), encrypted ("wrapped") using the public key of the KAS identified by\xa0url\xa0(and optionally\xa0kid).'}),(0,n.jsx)(t.td,{children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"policyBinding"}),(0,n.jsx)(t.td,{children:"Object"}),(0,n.jsxs)(t.td,{children:["An object containing a keyed hash binding the\xa0policy\xa0string from\xa0",(0,n.jsx)(t.a,{href:"/preview-ad81f576/spec/schema/opentdf/encryption_information",children:"encryptionInformation"}),"\xa0to this specific\xa0wrappedKey. This prevents policy tampering without access to the key share."]}),(0,n.jsx)(t.td,{children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"kid"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"Optional. An identifier for the specific public key at the KAS (url) used to wrap the\xa0wrappedKey. This could be a key fingerprint, UUID, etc. Aids key rotation."}),(0,n.jsx)(t.td,{children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"sid"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"Optional. A Key Split (or Share) Identifier. If present, it indicates this\xa0wrappedKey\xa0represents only a\xa0share\xa0of the full payload key. Multiple\xa0keyAccess\xa0objects with different\xa0sid\xa0values (but potentially the same\xa0type/url) might need to be combined (e.g., via XOR) by the client after receiving unwrapped shares from respective KASes to reconstruct the final payload key. The\xa0encryptionInformation.type\xa0(split) governs this behavior."}),(0,n.jsx)(t.td,{children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"encryptedMetadata"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"Optional. Base64 encoded, encrypted metadata associated with this key access entry. Contains client-provided information (e.g., request context) passed to the KAS during rewrap requests. The KAS decrypts this using its private key. The content is freeform and SHOULD NOT be used for primary access decisions."}),(0,n.jsx)(t.td,{children:"No"})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"policy-binding-object-keyaccesspolicybinding",children:"Policy Binding Object (keyAccess.policyBinding)"}),"\n",(0,n.jsx)(t.p,{children:"This nested object provides the cryptographic binding between the policy and the key share."}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{}),(0,n.jsx)(t.th,{}),(0,n.jsx)(t.th,{}),(0,n.jsx)(t.th,{})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Parameter"}),(0,n.jsx)(t.td,{children:"Type"}),(0,n.jsx)(t.td,{children:"Description"}),(0,n.jsx)(t.td,{children:"Required?"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"alg"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsx)(t.td,{children:"The algorithm used to generate the\xa0hash.\xa0HS256\xa0(HMAC-SHA256) is commonly used."}),(0,n.jsx)(t.td,{children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"hash"}),(0,n.jsx)(t.td,{children:"String"}),(0,n.jsxs)(t.td,{children:["A Base64 encoding of\xa0HMAC(KEY, POLICY), where:",(0,n.jsx)("br",{}),"-\xa0POLICY: The Base64 encoded policy string from\xa0encryptionInformation.policy.",(0,n.jsx)("br",{}),"-\xa0HMAC: The algorithm specified by\xa0alg\xa0(e.g., HMAC-SHA256).",(0,n.jsx)("br",{}),"-\xa0KEY: The\xa0plaintext\xa0symmetric key corresponding to the\xa0wrappedKey\xa0in this Key Access Object (i.e., the key share itself). The KAS verifies this binding upon receiving a rewrap request before proceeding."]}),(0,n.jsx)(t.td,{children:"Yes"})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>c,x:()=>d});var i=s(96540);const n={},r=i.createContext(n);function c(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);